package cs333;

import javafx.fxml.FXML;
import javafx.scene.control.Button;
import javafx.scene.control.ComboBox;
import javafx.scene.control.TextField;

public class UnitConverterController {

	@FXML
	private ComboBox<String> modeComboBox; // "English → Metric" or "Metric → English"
	@FXML
	private ComboBox<String> unitTypeComboBox; // "Weight", "Length", "Temperature", "Speed"
	@FXML
	private TextField valueTextField;
	@FXML
	private TextField resultTextField;
	@FXML
	private Button converterButton;

	@FXML
	public void initialize() {
		// Populate dropdowns here (avoids FXML <String> parsing issues)
		modeComboBox.getItems().setAll("English → Metric", "Metric → English");
		modeComboBox.getSelectionModel().selectFirst();

		unitTypeComboBox.getItems().setAll("Weight", "Length", "Temperature", "Speed");
		unitTypeComboBox.getSelectionModel().selectFirst();

		converterButton.setOnAction(e -> convertUnits());
	}

	private void convertUnits() {
		String mode = modeComboBox.getValue();
		String type = unitTypeComboBox.getValue();

		String raw = valueTextField.getText().trim();
		if (raw.isEmpty()) {
			resultTextField.setText("Enter a number first.");
			return;
		}

		double value;
		try {
			value = Double.parseDouble(raw);
		} catch (NumberFormatException ex) {
			resultTextField.setText("Invalid number.");
			return;
		}

		String result;
		switch (type) {
		case "Weight" -> {
			if (isMetricToEnglish(mode)) {
				// kg -> lb
				double pounds = value * 2.20462;
				result = String.format("%.2f kg → %.2f lb", value, pounds);
			} else {
				// lb -> kg
				double kg = value / 2.20462;
				result = String.format("%.2f lb → %.2f kg", value, kg);
			}
		}
		case "Length" -> {
			if (isMetricToEnglish(mode)) {
				// km -> mi
				double miles = value * 0.621371;
				result = String.format("%.2f km → %.2f mi", value, miles);
			} else {
				// mi -> km
				double km = value / 0.621371;
				result = String.format("%.2f mi → %.2f km", value, km);
			}
		}
		case "Temperature" -> {
			if (isMetricToEnglish(mode)) {
				// °C -> °F
				double f = (value * 9 / 5) + 32;
				result = String.format("%.2f °C → %.2f °F", value, f);
			} else {
				// °F -> °C
				double c = (value - 32) * 5 / 9;
				result = String.format("%.2f °F → %.2f °C", value, c);
			}
		}
		case "Speed" -> {
			if (isMetricToEnglish(mode)) {
				// km/h -> mph
				double mph = value * 0.621371;
				result = String.format("%.2f km/h → %.2f mph", value, mph);
			} else {
				// mph -> km/h
				double kph = value / 0.621371;
				result = String.format("%.2f mph → %.2f km/h", value, kph);
			}
		}
		default -> result = "Select a unit type.";
		}

		resultTextField.setText(result);
	}

	private boolean isMetricToEnglish(String mode) {
		return "Metric → English".equals(mode);
	}
}

